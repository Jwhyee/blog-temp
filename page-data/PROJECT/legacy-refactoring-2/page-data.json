{"componentChunkName":"component---src-templates-blog-post-js","path":"/PROJECT/legacy-refactoring-2/","result":{"data":{"site":{"siteMetadata":{"title":"Jwhy Blogitory","author":"[Jwhy]","siteUrl":"https://jwhyee.github.io","comment":{"disqusShortName":"","utterances":"Jwhyee/Jwhyee.github.io"},"sponsor":{"buyMeACoffeeId":"jwhy"}}},"markdownRemark":{"id":"a83ede3b-365d-5f5e-a65f-ec76314d92a0","excerpt":"ğŸ›  ìˆ˜ì • 1ì¼ì°¨ ì´ì „ í˜ì´ì§€ì—ì„œ ì„¤ëª…í•œ ê²ƒê³¼ ê°™ì´ í•´ë‹¹ í”„ë¡œì íŠ¸ì˜ ê°€ì¥ í° ë¬¸ì œì ì€ ì—ì„œ  ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì§€ ëª»í•œë‹¤ëŠ” ê²ƒì´ë‹¤.\nì¦‰, ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì™€ ê´€ë ¨ëœ ë¡œì§ ê³ ë„í™”ë¥¼ ì§„í–‰í•˜ê³ , ì—ë„ ì ìš©í•  ì˜ˆì •ì´ë‹¤. ğŸ”¢ ë¬¸ì œ í•´ê²° ë‹¨ê³„ ì˜ ê´€ì‹¬ì‚¬ ë¶„ë¦¬  ë¦¬íŒ©í„°ë§  ë„ì…  ì ìš© 1ï¸âƒ£ ì˜ ê´€ì‹¬ì‚¬ ë¶„ë¦¬ í˜„ì¬ ì—ëŠ” íšŒì›ê³¼ ê´€ë ¨ëœ ëª¨ë“  ì„œë¹„ìŠ¤ ë¡œì§ì´ í¬í•¨ë˜ì–´ ìˆë‹¤.\nê·¸ ì¤‘ì—ì„œë„ ë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì´ í¬í•¨ë˜ì–´ ìˆì–´ ë¶„ë¦¬í•˜ê³ ì í•œë‹¤. ìœ„ ì½”ë“œì™€ ê°™ì´ ê¸°íƒ€ ë¡œì§ë“¤ ê°€ìš´ë° loadUserByUsernameâ€¦","html":"<h2 id=\"-ìˆ˜ì •-1ì¼ì°¨\" style=\"position:relative;\"><a href=\"#-%EC%88%98%EC%A0%95-1%EC%9D%BC%EC%B0%A8\" aria-label=\" ìˆ˜ì • 1ì¼ì°¨ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ›  ìˆ˜ì • 1ì¼ì°¨</h2>\n<p>ì´ì „ í˜ì´ì§€ì—ì„œ ì„¤ëª…í•œ ê²ƒê³¼ ê°™ì´ í•´ë‹¹ í”„ë¡œì íŠ¸ì˜ ê°€ì¥ í° ë¬¸ì œì ì€ <code class=\"language-text\">Thymeleaf</code>ì—ì„œ <code class=\"language-text\">Security</code> ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì§€ ëª»í•œë‹¤ëŠ” ê²ƒì´ë‹¤.<br>\nì¦‰, ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ <code class=\"language-text\">Security</code>ì™€ ê´€ë ¨ëœ ë¡œì§ ê³ ë„í™”ë¥¼ ì§„í–‰í•˜ê³ , <code class=\"language-text\">Thymeleaf</code>ì—ë„ ì ìš©í•  ì˜ˆì •ì´ë‹¤.</p>\n<h2 id=\"-ë¬¸ì œ-í•´ê²°-ë‹¨ê³„\" style=\"position:relative;\"><a href=\"#-%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0-%EB%8B%A8%EA%B3%84\" aria-label=\" ë¬¸ì œ í•´ê²° ë‹¨ê³„ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ”¢ ë¬¸ì œ í•´ê²° ë‹¨ê³„</h2>\n<ol>\n<li><code class=\"language-text\">AccountService</code>ì˜ ê´€ì‹¬ì‚¬ ë¶„ë¦¬</li>\n<li><code class=\"language-text\">SecurityConfig</code> ë¦¬íŒ©í„°ë§</li>\n<li><code class=\"language-text\">layout</code> ë„ì…</li>\n<li><code class=\"language-text\">thymeleaf Security</code> ì ìš©</li>\n</ol>\n<h3 id=\"1ï¸âƒ£-code-classlanguage-textaccountservicecodeì˜-ê´€ì‹¬ì‚¬-ë¶„ë¦¬\" style=\"position:relative;\"><a href=\"#1%EF%B8%8F%E2%83%A3-code-classlanguage-textaccountservicecode%EC%9D%98-%EA%B4%80%EC%8B%AC%EC%82%AC-%EB%B6%84%EB%A6%AC\" aria-label=\"1ï¸âƒ£ code classlanguage textaccountservicecodeì˜ ê´€ì‹¬ì‚¬ ë¶„ë¦¬ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1ï¸âƒ£ <code class=\"language-text\">AccountService</code>ì˜ ê´€ì‹¬ì‚¬ ë¶„ë¦¬</h3>\n<p>í˜„ì¬ <code class=\"language-text\">AccountService</code>ì—ëŠ” íšŒì›ê³¼ ê´€ë ¨ëœ ëª¨ë“  ì„œë¹„ìŠ¤ ë¡œì§ì´ í¬í•¨ë˜ì–´ ìˆë‹¤.<br>\nê·¸ ì¤‘ì—ì„œë„ <code class=\"language-text\">UserDetailsService</code>ë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì´ í¬í•¨ë˜ì–´ ìˆì–´ ë¶„ë¦¬í•˜ê³ ì í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AccountService</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">UserDetailsService</span> <span class=\"token punctuation\">{</span>\n    \n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    \n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">UserDetails</span> <span class=\"token function\">loadUserByUsername</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> emailOrNickname<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">UsernameNotFoundException</span> <span class=\"token punctuation\">{</span>\n        log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"UserDetail : mainOrNickname ={}\"</span><span class=\"token punctuation\">,</span> emailOrNickname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">Account</span> account <span class=\"token operator\">=</span> accountRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findByEmail</span><span class=\"token punctuation\">(</span>emailOrNickname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>account <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UsernameNotFoundException</span><span class=\"token punctuation\">(</span>emailOrNickname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SecurityUser</span><span class=\"token punctuation\">(</span>account<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ìœ„ ì½”ë“œì™€ ê°™ì´ ê¸°íƒ€ ë¡œì§ë“¤ ê°€ìš´ë° loadUserByUsernameì´ í¬í•¨ë˜ì–´ ìˆìœ¼ë©°,<br>\ní•´ë‹¹ ë©”ì†Œë“œì— ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” ê¸°ëŠ¥ì´ ë¹ ì ¸ìˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì•„ë˜ì™€ ê°™ì´ êµ¬í˜„í•˜ì˜€ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Service</span>\n<span class=\"token annotation punctuation\">@RequiredArgsConstructor</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomUserDetailsService</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">UserDetailsService</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">AccountRepository</span> accountRepository<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">UserDetails</span> <span class=\"token function\">loadUserByUsername</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> emailOrNickname<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">UsernameNotFoundException</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Account</span> account <span class=\"token operator\">=</span> accountRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findByEmail</span><span class=\"token punctuation\">(</span>emailOrNickname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">GrantedAuthority</span><span class=\"token punctuation\">></span></span> authorities <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>account<span class=\"token punctuation\">.</span><span class=\"token function\">getUsername</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            authorities<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleGrantedAuthority</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ADMIN\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        \n        authorities<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleGrantedAuthority</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MEMBER\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SecurityUser</span><span class=\"token punctuation\">(</span>account<span class=\"token punctuation\">,</span> authorities<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ìƒˆë¡œìš´ <code class=\"language-text\">CustomUserDetailsService</code>ë¥¼ ìƒì„±í•´ì„œ ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬í•˜ì˜€ìœ¼ë©°, ë‚´ë¶€ ë¡œì§ë„ ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆë„ë¡ ë¡œì§ì„ êµ¬ì„±í•´ì£¼ì—ˆë‹¤.<br>\n<code class=\"language-text\">List</code>ë¥¼ ì´ìš©í•œ ì´ìœ ëŠ” í•œ íšŒì›ì´ MEMBER, ADMIN ë“± ì—¬ëŸ¬ ê¶Œí•œì„ ê°€ì§ˆ ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•¨ì´ë‹¤.</p>\n<h3 id=\"2ï¸âƒ£-code-classlanguage-textsecurityconfigcode-ë¦¬íŒ©í„°ë§\" style=\"position:relative;\"><a href=\"#2%EF%B8%8F%E2%83%A3-code-classlanguage-textsecurityconfigcode-%EB%A6%AC%ED%8C%A9%ED%84%B0%EB%A7%81\" aria-label=\"2ï¸âƒ£ code classlanguage textsecurityconfigcode ë¦¬íŒ©í„°ë§ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2ï¸âƒ£ <code class=\"language-text\">SecurityConfig</code> ë¦¬íŒ©í„°ë§</h3>\n<p>ìš°ì„  ì•„ë˜ ë ˆê±°ì‹œ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ì.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SecurityConfig</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">WebSecurityConfigurerAdapter</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">AccountService</span> accountService<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">DataSource</span> dataSource<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">configure</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpSecurity</span> http<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n\n        http<span class=\"token punctuation\">.</span><span class=\"token function\">authorizeRequests</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">mvcMatchers</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/sign-up\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/check-email\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/check-email-token\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"/email-login\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/check-email-login\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/login-link\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/email-login-view\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">permitAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">antMatchers</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/study/*\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/board/*\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/council/*\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/logout\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">authenticated</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">mvcMatchers</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpMethod</span><span class=\"token punctuation\">.</span>GET<span class=\"token punctuation\">,</span> <span class=\"token string\">\"/profile/*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">permitAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">antMatchers</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/manager/*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasAnyRole</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ADMIN\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">anyRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">authenticated</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        http<span class=\"token punctuation\">.</span><span class=\"token function\">logout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">logoutUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/logout\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">logoutSuccessUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        http<span class=\"token punctuation\">.</span><span class=\"token function\">formLogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">loginPage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">defaultSuccessUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        http<span class=\"token punctuation\">.</span><span class=\"token function\">formLogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">loginProcessingUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">defaultSuccessUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        http<span class=\"token punctuation\">.</span><span class=\"token function\">exceptionHandling</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">accessDeniedPage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        http<span class=\"token punctuation\">.</span><span class=\"token function\">userDetailsService</span><span class=\"token punctuation\">(</span>accountService<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        http<span class=\"token punctuation\">.</span><span class=\"token function\">rememberMe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">userDetailsService</span><span class=\"token punctuation\">(</span>accountService<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">tokenRepository</span><span class=\"token punctuation\">(</span><span class=\"token function\">tokenRepository</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ìš°ì„  ê°€ì¥ í° ë¬¸ì œì ì€ <code class=\"language-text\">WebSecurityConfigurerAdapter</code>ê°€ <code class=\"language-text\">deprecated</code> ë˜ì—ˆë‹¤ëŠ” ì ì´ë‹¤.<br>\nì¦‰, ìŠ¤í”„ë§ ë²„ì „ì´ ì˜¬ë¼ê°€ë©´ì„œ í•´ë‹¹ í´ë˜ìŠ¤ì˜ ì‚¬ìš©ì„ ê¶Œì¥í•˜ì§€ ì•Šê³  ìˆë‹¤.<br>\nì´ë¥¼ ëŒ€ì²´í•˜ê¸° ìœ„í•´ <code class=\"language-text\">SecurityFilterChain</code>ì„ <code class=\"language-text\">Bean</code>ìœ¼ë¡œ ë“±ë¡í•´ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•˜ê³  ìˆë‹¤.<br>\ní•´ë‹¹ ë‚´ìš©ì€ <a href=\"https://spring.io/blog/2022/02/21/spring-security-without-the-websecurityconfigureradapter\">ê³µì‹ë¬¸ì„œ</a>ì— ë‚˜ì™€ ìˆìœ¼ë‹ˆ í™•ì¸í•´ë³´ëŠ”ê²Œ ì¢‹ì„ ê²ƒ ê°™ë‹¤.<br></p>\n<p>ìœ„ ë‚´ìš©ì„ ë‹´ì„ ìˆ˜ ìˆëŠ” <code class=\"language-text\">filterChain</code>ì„ êµ¬í˜„í•´ë³´ì.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token annotation punctuation\">@EnableWebSecurity</span>\n<span class=\"token annotation punctuation\">@EnableGlobalMethodSecurity</span><span class=\"token punctuation\">(</span>prePostEnabled <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SecurityConfig</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SecurityFilterChain</span> <span class=\"token function\">filterChain</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpSecurity</span> http<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        http\n                <span class=\"token punctuation\">.</span><span class=\"token function\">formLogin</span><span class=\"token punctuation\">(</span>\n                        formLogin <span class=\"token operator\">-></span> formLogin\n                                <span class=\"token punctuation\">.</span><span class=\"token function\">loginPage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">)</span>\n                                <span class=\"token punctuation\">.</span><span class=\"token function\">loginProcessingUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">logout</span><span class=\"token punctuation\">(</span>\n                        logout <span class=\"token operator\">-></span> logout\n                                <span class=\"token punctuation\">.</span><span class=\"token function\">logoutUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/logout\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">authorizeRequests</span><span class=\"token punctuation\">(</span>\n                        request <span class=\"token operator\">-></span> request\n                                <span class=\"token punctuation\">.</span><span class=\"token function\">antMatchers</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/study/**\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/board/**\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/council/**\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">authenticated</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                                <span class=\"token punctuation\">.</span><span class=\"token function\">antMatchers</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/manager/**\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasAnyRole</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ADMIN\"</span><span class=\"token punctuation\">)</span>\n                                <span class=\"token punctuation\">.</span><span class=\"token function\">anyRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">permitAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">csrf</span><span class=\"token punctuation\">(</span>\n                        csrf <span class=\"token operator\">-></span> csrf\n                                <span class=\"token punctuation\">.</span><span class=\"token function\">ignoringAntMatchers</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/h2-console/**\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> http<span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ìœ„ ë‘ ì½”ë“œì˜ í° ì°¨ì´ëŠ” ë³„ë¡œ ì—†ë‹¤.<br>\nëŒë‹¤ì‹ì„ ì´ìš©í•´ ë¡œì§ì„ êµ¬ì„±í•œ ê²ƒê³¼ ê¶Œí•œ ë¶€ì—¬ì— ëŒ€í•œ ì°¨ì´ ë§ê³ ëŠ” ì—†ë‹¤.<br>\ní˜„ì¬ëŠ” ë¡œê·¸ì¸ì„ í•´ì•¼ ì„œë¹„ìŠ¤ê°€ ì´ìš© ê°€ëŠ¥í•˜ë„ë¡ ì§€ì •í•´ë†“ì•˜ìœ¼ë‹ˆ,\nì¶”í›„ <code class=\"language-text\">layout</code>ì„ ì ìš©í•˜ë©´ì„œ <code class=\"language-text\">Thymeleaf Security</code>ë¥¼ ë„ì…í•œ ë’¤ ì¶”ê°€ë¡œ ë³€ê²½í•  ì˜ˆì •ì´ë‹¤.</p>\n<h3 id=\"3ï¸âƒ£-code-classlanguage-textlayoutcode-ì ìš©\" style=\"position:relative;\"><a href=\"#3%EF%B8%8F%E2%83%A3-code-classlanguage-textlayoutcode-%EC%A0%81%EC%9A%A9\" aria-label=\"3ï¸âƒ£ code classlanguage textlayoutcode ì ìš© permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3ï¸âƒ£ <code class=\"language-text\">layout</code> ì ìš©</h3>\n<p>ì§„í–‰ ì¤‘</p>","frontmatter":{"title":"[Spring][Refactoring] - ë ˆê±°ì‹œ ì½”ë“œ ë¦¬íŒ©í„°ë§(1)","date":"December 21, 2022"}}},"pageContext":{"slug":"/PROJECT/legacy-refactoring-2/","previous":{"fields":{"slug":"/PROJECT/legacy-refactoring-1/"},"frontmatter":{"title":"[Spring][Refactoring] - ë ˆê±°ì‹œ ì½”ë“œ ë¦¬íŒ©í„°ë§(0)"}},"next":{"fields":{"slug":"/ERROR/entity-manager-factory-error/"},"frontmatter":{"title":"[Spring][ERROR] - entity-manager-factory-error"}}}}}